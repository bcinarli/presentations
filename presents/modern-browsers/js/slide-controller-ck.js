(function(e){function n(){this.popup=null;this.isPopup=e.opener;if(this.setupDone()){e.addEventListener("message",this.onMessage_.bind(this),!1);e.addEventListener("beforeunload",function(e){this.popup&&this.popup.close()}.bind(this),!1)}}var t=location.protocol+"//"+location.host;n.PRESENTER_MODE_PARAM="presentme";n.prototype.setupDone=function(){var t=location.search.substring(1).split("&").map(function(e){return e.split("=")}),r=null;for(var i=0,s;s=t[i];++i)if(s[0].toLowerCase()==n.PRESENTER_MODE_PARAM){r=s[1]=="true";break}if(r!==null){localStorage.ENABLE_PRESENTOR_MODE=r;if(!e.history.replaceState){location.replace(location.pathname);return!1}e.history.replaceState({},"",location.pathname)}var o=localStorage.getItem("ENABLE_PRESENTOR_MODE");if(o&&JSON.parse(o)&&!this.isPopup){var u="menubar=no,location=yes,resizable=yes,scrollbars=no,status=no";this.popup=e.open(location.href,"mywindow",u);this.popup.addEventListener("load",function(e){var t=this.popup.document.createEvent("Event");t.initEvent("keydown",!0,!0);t.keyCode="P".charCodeAt(0);this.popup.document.dispatchEvent(t)}.bind(this),!1)}return!0};n.prototype.onMessage_=function(e){var t=e.data;if("keyCode"in t){var n=document.createEvent("Event");n.initEvent("keydown",!0,!0);n.keyCode=t.keyCode;document.dispatchEvent(n)}};n.prototype.sendMsg=function(t){this.isPopup&&e.opener.postMessage(t,"*")};e.SlideController=n})(window);